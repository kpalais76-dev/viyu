<view class="page-container">
  
  <view class="header-section">
    <view class="asset-card">
      <view class="asset-row">
        <view>
          <view class="asset-label">装备总估值 (CNY)</view>
          <view class="asset-value">¥ {{totalValue}}</view>
        </view>
        <view class="asset-count-box">
          <text class="count-num">{{totalCount}}</text>
          <text class="count-label">件库存</text>
        </view>
      </view>
    </view>
  </view>

  <view class="tab-wrapper">
    <view class="tab-item {{currentTab===0 ? 'active' : ''}}" bindtap="switchTab" data-idx="0">我的库存</view>
    <view class="tab-item {{currentTab===1 ? 'active' : ''}}" bindtap="switchTab" data-idx="1">战术方案</view>
  </view>

  <view class="list-container">
    
    <view class="add-btn-card" bindtap="handleAddGear">
      <view class="dashed-box">
        <text class="plus-icon">+</text>
        <text>{{currentTab === 0 ? '入库新装备 / 扫码' : '组装新战术方案'}}</text>
      </view>
    </view>

    <block wx:if="{{currentTab === 0}}">
      <view class="gear-card" wx:for="{{gearList}}" wx:key="_id" bindtap="handleEdit" data-id="{{item._id}}">
        <view class="type-tag {{item.category}}">
          {{item.category === 'rod' ? '竿' : item.category === 'reel' ? '轮' : item.category === 'line' ? '线' : '漂'}}
        </view>
        
        <view class="card-content">
          <view class="card-title">{{item.brand}} {{item.series}}</view>
          <view class="card-subtitle">{{item.model}} <text wx:if="{{item.param}}" class="divider">|</text> {{item.param}}</view>
        </view>

        <view class="action-btn" catchtap="handleDelete" data-id="{{item._id}}" data-name="{{item.name}}">
          <text class="del-icon">✕</text>
        </view>
      </view>

      <view wx:if="{{gearList.length === 0}}" class="empty-tip">库存空空如也，快去扫码入库吧</view>
    </block>

    <block wx:if="{{currentTab === 1}}">
      <view class="gear-card setup-card" wx:for="{{setupList}}" wx:key="_id" bindtap="handleEdit" data-id="{{item._id}}">
        <view class="type-tag setup">案</view>
        
        <view class="card-content">
          <view class="card-title">
            {{item.name}}
            <text class="method-badge">{{item.method_name}}</text>
          </view>
          <view class="card-subtitle">{{item.rod.name || '无竿'}} + {{item.reel.name || '无轮'}}</view>
        </view>

        <view class="action-btn" catchtap="handleDelete" data-id="{{item._id}}" data-name="{{item.name}}">
          <text class="del-icon">✕</text>
        </view>
      </view>
      
      <view wx:if="{{setupList.length === 0}}" class="empty-tip">暂无战术方案，点击上方组装</view>
    </block>

  </view>
  
  <view style="height: 120rpx;"></view>
</view>