<view class="gateway-container">
  
  <view class="gateway-header">
    <view class="title">{{mode === 'gear' ? 'CHOOSE CATEGORY' : 'SELECT TACTICS'}}</view>
    <view class="subtitle">
      {{mode === 'gear' ? 'è¯·é€‰æ‹©è¦å…¥åº“çš„è£…å¤‡ç±»å‹' : 'è¯·é€‰æ‹©è¦éƒ¨ç½²çš„æˆ˜æœ¯æµæ´¾'}}
    </view>
  </view>

  <view class="scan-tip-bar" wx:if="{{showCategoryModal}}">
  <view class="tip-content">
    <text class="tip-icon">âœ¨</text>
    <text>å·²è¯†åˆ«: {{scannedData.name || 'æ–°è£…å¤‡'}} ({{scannedData.barcode}})</text>
  </view>
  <view class="tip-sub">è¯·ç‚¹å‡»ä¸‹æ–¹å›¾æ ‡ï¼Œé€‰æ‹©è¯¥è£…å¤‡çš„åˆ†ç±» â†“</view>
  <view class="close-btn" bindtap="closeModal">å–æ¶ˆ</view>
</view>

<view class="scan-fab" bindtap="onScan" wx:if="{{mode === 'gear' && !showCategoryModal}}">
  <image src="/images/icons/goods.png" class="scan-icon" /> <text>æ‰«ç å…¥åº“</text>
</view>

  <block wx:if="{{mode === 'gear'}}">
    <view 
      class="group-section" 
      wx:for="{{gearGroups}}" 
      wx:key="key"
    >
      <view class="group-head">
        <text class="gh-name">{{item.name}}</text>
        <text class="gh-desc">// {{item.desc}}</text>
      </view>

      <view class="grid-body {{item.key === 'consumable' ? 'col-3' : 'col-2'}}">
        <view 
          class="grid-card {{item.key === 'core' ? 'card-lg' : ''}}" 
          wx:for="{{item.sub_types}}" 
          wx:key="key" 
          wx:for-item="sub"
          bindtap="onSelectType"
          data-parent="{{item.key}}"
          data-type="{{sub.key}}"
          data-name="{{sub.name}}"
        >
          <text class="card-icon">{{sub.icon}}</text>
          <text class="card-name">{{sub.name}}</text>
          <text class="card-en">{{sub.key}}</text>
          <view class="corner"></view>
        </view>
      </view>
    </view>
  </block>

  <block wx:if="{{mode === 'setup'}}">
    <view class="group-section">
      <view class="group-head">
        <text class="gh-name">TACTICAL SCHOOLS // æˆ˜æœ¯ä½“ç³»</text>
      </view>
      <view class="grid-body col-1">
        <view 
          class="grid-card card-lg" 
          wx:for="{{methods}}" 
          wx:key="key"
          bindtap="onSelectMethod"
          data-key="{{item.key}}"
          style="align-items: flex-start; padding-left: 40rpx;"
        >
          <text class="card-name" style="font-size: 32rpx;">{{item.name}}</text>
          <text class="card-en" style="margin-top: 8rpx;">{{item.desc}}</text>
          <text class="card-en" style="color: #2962FF; margin-top: 16rpx;">ç‚¹å‡»éƒ¨ç½² ></text>
        </view>
      </view>
    </view>
  </block>

  <view class="switch-mode-bar" bindtap="switchMode">
    <block wx:if="{{mode === 'gear'}}">
      <text>æƒ³è¦ç»„è£…å¥—è£…ï¼Ÿ</text>
      <text class="link">å»æ–°å»ºæˆ˜æœ¯é…ç½® ></text>
    </block>
    <block wx:else>
      <text>ç¼ºå°‘é…ä»¶ï¼Ÿ</text>
      <text class="link">å»å½•å…¥å•å“è£…å¤‡ ></text>
    </block>
  </view>

  <view class="scan-bar" bindtap="onScan" wx:if="{{mode === 'gear'}}">
    <text class="scan-icon">ğŸ“¸</text>
    <text>æ‰«ç è¯†åˆ«å…¥åº“ (Beta)</text>
  </view>

</view>